<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bridge to System Package Manager • bspm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bridge to System Package Manager">
<meta property="og:description" content="Enables binary package installations on Linux distributions.
    Provides functions to manage packages via the distributions package
    manager. Also provides transparent integration with Rs install.packages()
    and a fallback mechanism. When installed as a system package, interacts
    with the system's package manager without requiring administrative
    privileges via an integrated D-Bus service; otherwise, uses sudo.
    Currently, the following backends are supported: DNF, APT, ALPM.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bspm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Enchufa2/bspm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="bspm-bridge-to-system-package-manager">bspm: Bridge to System Package Manager<a class="anchor" aria-label="anchor" href="#bspm-bridge-to-system-package-manager"></a>
</h1></div>
<!-- badges: start -->
<p>Enables binary package installations on Linux distributions. Provides functions to manage packages via the distribution’s package manager. Also provides transparent integration with R’s install.packages() and a fallback mechanism. When installed as a system package, interacts with the system’s package manager without requiring administrative privileges via an integrated D-Bus service; otherwise, uses sudo. Currently, the following backends are supported: DNF, APT, ALPM.</p>
<p>See our contributed talk at <em>useR! 2021</em>: [<a href="https://youtu.be/GMMGBlyl_ok?t=1170" class="external-link">video</a>, <a href="https://enchufa2.github.io/bspm/slides/20210709-useR2021_talk.html" class="external-link">slides</a>].</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Installation from system repositories is preferred, mainly to avoid issues on SELinux-enabled systems (see <a href="https://github.com/Enchufa2/bspm/issues/19" class="external-link">#19</a>).</p>
<ul>
<li>Follow these links if the target system is a desktop/server installation of one of the supported distributions: <a href="#fedora">Fedora</a>, <a href="#ubuntu">Ubuntu</a>, <a href="#opensuse">openSUSE</a>, <a href="#arch">Arch</a>.</li>
<li>If the target system is a containerized application (e.g., a Docker image), refer to the <a href="https://github.com/rocker-org/rocker/tree/master/r-bspm" class="external-link"><code>rocker/r-bspm</code> images</a>.</li>
<li>If you are trying <code>bspm</code> in another distro, or you are packaging it as a system package, please follow the general procedure below.</li>
</ul>
<div class="section level3">
<h3 id="general-procedure">General procedure<a class="anchor" aria-label="anchor" href="#general-procedure"></a>
</h3>
<p>Installation from source requires (apart from R) the folllowing Python bindings:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Package manager</th>
<th>DBus (*)</th>
<th>GObject (*)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Fedora/RedHat</td>
<td><code>python3-dnf</code></td>
<td><code>python3-dbus</code></td>
<td><code>python3-gobject</code></td>
</tr>
<tr class="even">
<td>Ubuntu/Debian</td>
<td><code>python3-apt</code></td>
<td><code>python3-dbus</code></td>
<td><code>python3-gi</code></td>
</tr>
<tr class="odd">
<td>openSUSE</td>
<td><code>python3-dnf</code></td>
<td><code>python38-dbus-python</code></td>
<td><code>python3-gobject</code></td>
</tr>
<tr class="even">
<td>Arch</td>
<td><code>pyalpm</code></td>
<td><code>python-dbus</code></td>
<td><code>python-gobject</code></td>
</tr>
</tbody>
</table>
<p>(*) Optional, only required if you plan to run <code>bspm</code> as a regular user (non-root) in a (systemd-based) desktop/server setting.</p>
<p>Then, you should install <code>bspm</code> as a system package to be able to use it as a regular user. Download the latest version from CRAN or GitHub and proceed with the installation (note <code>sudo</code>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo R CMD INSTALL bspm_[version].tar.gz</span></code></pre></div>
<p>Further configuration options:</p>
<ul>
<li>If you plan to run it only as root (e.g., in a docker container), then you don’t need the D-Bus service, so you can disable its installation by adding <code>--configure-args="--without-dbus-service"</code>.</li>
<li>If you are installing the package in a build root, instead of its final destination, specify <code>--configure-vars="BUILD_ROOT=[path_to_build_root]"</code> too.</li>
<li>By default, package prefixes and exclusions are automatically discovered from system repositories, and this discovery mechanism is exposed so that the user can install other packages if e.g. new repositories with other prefixes are added. If you want to fix prefixes and exclusions and prevent exposing the discovery mechanism, set <code>--configure-vars="PKG_PREF='prefix1- prefix2- ...'"</code> and <code>--configure-vars="PKG_EXCL='exclusion1 exclusion2 ...'"</code>.</li>
</ul>
<p>To enable it by default, put the following into the <code>Rprofile.site</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> bspm<span class="sc">::</span><span class="fu">enable</span>() <span class="co"># wrap it in suppressMessages() to avoid the initial message</span></span></code></pre></div>
<p>Then, run <code>install.packages</code> as usual, and available system packages will be automatically installed.</p>
</div>
<div class="section level3">
<h3 id="fedora">Fedora<a class="anchor" aria-label="anchor" href="#fedora"></a>
</h3>
<p>There are thousands of binary packages available via the <a href="https://copr.fedorainfracloud.org/coprs/iucar/cran/" class="external-link">iucar/cran</a> Copr repo. The <code>bspm</code> package is available as <code>R-CoprManager</code>, and enabled by default:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf install <span class="st">'dnf-command(copr)'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf copr enable iucar/cran</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf install R-CoprManager</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ubuntu">Ubuntu<a class="anchor" aria-label="anchor" href="#ubuntu"></a>
</h3>
<p>There are thousands of binary packages available via the <a href="https://launchpad.net/~c2d4u.team/+archive/ubuntu/c2d4u4.0+" class="external-link">c2d4u.team/c2d4u4.0+</a> PPA repo:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo add-apt-repository ppa:marutter/rrutter4.0   <span class="co"># R v4.0 and higher</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo add-apt-repository ppa:c2d4u.team/c2d4u4.0+  <span class="co"># R packages</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo apt-get update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt-get install python3-<span class="dt">{dbus</span><span class="op">,</span><span class="dt">gi</span><span class="op">,</span><span class="dt">apt}</span></span></code></pre></div>
<p>Then, install <code>bspm</code> as a system package from CRAN:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo Rscript <span class="at">-e</span> <span class="st">'install.packages("bspm", repos="https://cran.r-project.org")'</span></span></code></pre></div>
<p>Then, to enable it system-wide (alternatively, use your <code>.Rprofile</code>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"bspm::enable()"</span> <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> /etc/R/Rprofile.site</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="opensuse">openSUSE<a class="anchor" aria-label="anchor" href="#opensuse"></a>
</h3>
<p>There are thousands of binary packages available via the <a href="https://build.opensuse.org/project/show/devel:languages:R:autoCRAN" class="external-link">autoCRAN</a> OBS repo:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo zypper ar <span class="at">-r</span> https://download.opensuse.org/repositories/devel:/languages:/R:/patched/openSUSE_Tumbleweed/devel:languages:R:patched.repo</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo zypper ar <span class="at">-r</span> https://download.opensuse.org/repositories/devel:/languages:/R:/autoCRAN/openSUSE_Tumbleweed/devel:languages:R:autoCRAN.repo</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo zypper install R-patched python3-dnf python38-dbus-python python3-gobject</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo ln <span class="at">-s</span> /etc/zypp/repos.d /etc/yum.repos.d</span></code></pre></div>
<p>Then, install <code>bspm</code> as a system package from CRAN:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo Rscript <span class="at">-e</span> <span class="st">'install.packages("bspm", repos="https://cran.r-project.org")'</span></span></code></pre></div>
<p>Then, to enable it system-wide (alternatively, use your <code>.Rprofile</code>):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"bspm::enable()"</span> <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> /usr/lib64/R/etc/Rprofile.site</span></code></pre></div>
<p>Sometimes, a restart is required so that the new systemd service is recognized.</p>
</div>
<div class="section level3">
<h3 id="arch">Arch<a class="anchor" aria-label="anchor" href="#arch"></a>
</h3>
<p>There are a number of binary CRAN packages available via the <a href="https://github.com/dvdesolve/ArchRPkgs" class="external-link">ArchRPkgs</a> repo as well as Bioconductor packages via the <a href="https://github.com/BioArchLinux/Packages" class="external-link">BioArchLinux</a> repo:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="at">-e</span> <span class="st">"\n[desolve]\nServer = https://desolve.ru/archrepo/</span><span class="dt">\$</span><span class="st">arch"</span> <span class="dt">\</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"\n[BioArchLinux]\nServer = https://repo.bioarchlinux.org/</span><span class="dt">\$</span><span class="st">arch"</span> <span class="dt">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> /etc/pacman.conf</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo pacman <span class="at">-Sy</span> <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> pacman <span class="at">-S</span> r pyalpm python-<span class="dt">{dbus</span><span class="op">,</span><span class="dt">gobject}</span></span></code></pre></div>
<p>Then, install <code>bspm</code> as a system package from CRAN:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo Rscript <span class="at">-e</span> <span class="st">'install.packages("bspm", repos="https://cran.r-project.org")'</span></span></code></pre></div>
<p>Then, to enable it system-wide (alternatively, use your <code>.Rprofile</code>):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> echo <span class="st">"bspm::enable()"</span> <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> /usr/lib64/R/etc/Rprofile.site</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="developing-new-backends">Developing new backends<a class="anchor" aria-label="anchor" href="#developing-new-backends"></a>
</h2>
<p>New backends for other package managers can be added to <code>inst/service/backend</code>. Each backend must implement the following functions:</p>
<ul>
<li><code>def discover() -&gt; dict({ "prefixes" : list, "exclusions" : list })</code></li>
<li><code>def install(prefixes : list, pkgs : list, exclusions : list) -&gt; list</code></li>
<li><code>def remove(prefixes : list, pkgs : list, exclusions : list) -&gt; list</code></li>
</ul>
<p>The last two functions receive a list of prefixes, a list of R package names and a list of exclusions, and must return a list with those package names that could not be processed (i.e., packages not found in the system repos). Any progress should be reported to stdout.</p>
</div>
<div class="section level2">
<h2 id="support-and-troubleshooting">Support and troubleshooting<a class="anchor" aria-label="anchor" href="#support-and-troubleshooting"></a>
</h2>
<p>If you are experiencing an issue that is not listed here, or the solution did not work for you, please do not hesitate to open a ticket at our <a href="https://github.com/Enchufa2/bspm/issues" class="external-link">GitHub issue tracker</a>.</p>
<div class="section level3">
<h3 id="cannot-connect-to-the-system-package-manager">Cannot connect to the system package manager<a class="anchor" aria-label="anchor" href="#cannot-connect-to-the-system-package-manager"></a>
</h3>
<p>Symptom: you tried to install a package and you got this message.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">install.packages</span>(<span class="sc">&lt;</span>some_package<span class="sc">&gt;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> install.packages <span class="sc">:</span> cannot connect to the system package manager</span></code></pre></div>
<p>This usually happens when <code>bspm</code> was installed in the user library or, as a system package, it is not properly configured for some reason. The solution is:</p>
<ol style="list-style-type: decimal">
<li>First and foremost, <strong>uninstall</strong> any copy of <code>bspm</code> in your user library.</li>
<li>Reinstall with admin privileges, e.g.:</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo Rscript <span class="at">--vanilla</span> <span class="at">-e</span> <span class="st">'install.packages("bspm", repos="https://cran.r-project.org")'</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=bspm" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/Enchufa2/bspm/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Enchufa2/bspm/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bspm</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Iñaki Ucar <br><small class="roles"> Author, copyright holder, maintainer </small> <a href="https://orcid.org/0000-0001-6403-5550" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Enchufa2/bspm/actions" class="external-link"><img src="https://github.com/Enchufa2/bspm/workflows/build/badge.svg" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=bspm" class="external-link"><img src="https://www.r-pkg.org/badges/version/bspm" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Iñaki Ucar.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
